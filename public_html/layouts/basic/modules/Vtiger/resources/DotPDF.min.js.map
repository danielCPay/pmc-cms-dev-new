{"version":3,"file":"DotPDF.min.js","sources":["DotPDF.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class('Vtiger_DotPDF_Js', {\n\t/*\n\t * Function to register the click event for generate button\n\t */\n\tregisterPreSubmitEvent: function (container) {\n\t\tconst self = this;\n\t\tcontainer.find('#generate_dot_pdf').on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tconst loader = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_PDF_GENERATING'),\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tlet templateElements = container.find('[name=\"pdf_template[]\"]');\n\t\t\tlet templateContainer = $(this).closest('.js-pdf-template-content');\n\t\t\ttemplateContainer.find('.js-pdf-user-variable').toggleClass('d-none');\n\t\n\t\t\tlet templates = [];\n\t\t\ttemplateElements.filter(':checked').each(function () {\n\t\t\t\ttemplates.push($(this).val());\n\t\t\t});\n\n\t\t\tlet params = container.find('form').serializeFormData();\n\t\t\tparams.templates = templates;\n\t\t\tparams.mode = 'generate';\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tvar response = data.result;\n\t\t\t\t\tif (response['message']) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\t\ttype: data['success'] ? 'success' : 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tlet detailInstance = Vtiger_Detail_Js.getInstance();\n\t\t\t\t\tif (detailInstance) {\n\t\t\t\t\t\tdetailInstance.reloadTabContent();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, err) {\n\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t});\n\t\t\n\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\tapp.hideModalWindow();\n\t\t});\n\t},\n\n\t/**\n\t * Register list view check records\n\t *\n\t * @param   {jQuery}  container\n\t */\n\tregisterListViewCheckRecords(container) {\n\t\tlet templateElements = container.find('[name=\"pdf_template[]\"]');\n\t\ttemplateElements.on('change', function () {\n\t\t\tdocument.progressLoader = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_PDF_RECALCULATING'),\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet templateContainer = $(this).closest('.js-pdf-template-content');\n\t\t\ttemplateContainer.find('.js-pdf-user-variable').toggleClass('d-none');\n\n\t\t\tlet templates = [];\n\t\t\ttemplateElements.filter(':checked').each(function () {\n\t\t\t\ttemplates.push($(this).val());\n\t\t\t});\n\n\t\t\tlet params = container.find('form').serializeFormData();\n\t\t\tparams.mode = 'validateRecords';\n\t\t\tparams.templates = templates;\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tvar response = data.result;\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\tlet valid = response.valid;\n\t\t\t\t\t\tlet info = container.find('.js-records-info').text(response.message).removeClass('d-none');\n\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\tinfo.addClass('d-none');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t}, 500);\n\n\t\t\t\t\t\tcontainer.find('.js-submit-button').each(function () {\n\t\t\t\t\t\t\t$(this).attr('disabled', !valid);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, err) {\n\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Register select custom columns change\n\t */\n\tregisterSelectCustomColumnsChange() {\n\t\tthis.container.find('[name=\"isCustomMode\"]').on('change', (ev) => {\n\t\t\tif ($(ev.target).is(':checked')) {\n\t\t\t\tthis.container.find('[name=\"inventoryColumns[]\"]').prop('disabled', null);\n\t\t\t\tthis.container.find('.js-save-scheme').prop('disabled', null);\n\t\t\t} else {\n\t\t\t\tthis.container.find('[name=\"inventoryColumns[]\"]').prop('disabled', 'disabled');\n\t\t\t\tthis.container.find('.js-save-scheme').prop('disabled', 'disabled');\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Register save scheme button click\n\t */\n\tregisterSaveInventoryColumnSchemeClick() {\n\t\tthis.container.find('.js-save-scheme').on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tconst loader = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet params = this.container.find('form').serializeFormData();\n\t\t\tparams.mode = 'saveInventoryColumnScheme';\n\t\t\tparams.isCustomMode = this.container.find('[name=\"isCustomMode\"]').is(':checked');\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tconst response = data['result'];\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t}\n\t\t\t\t\tif (response['message'] && data['success']) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, err) {\n\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t});\n\t\t});\n\t},\n\tregisterListViewFilter: function (container) {\n\t\tconst self = this;\n\t\tcontainer.find('.templates-filter').on('keyup', (e) => {\n\t\t\tconst element = $(e.currentTarget);\n\t\t\tconst filter = element.val().toLowerCase();\n\t\t\tconst classes = element.attr('class').split(/\\s+/);\n\t\t\tlet column = 'column-name';\n\t\t\tfor (let className of classes) {\n\t\t\t\tif (className.startsWith('column-')) {\n\t\t\t\t\tcolumn = className;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontainer.find('.js-pdf-template-content.row').each(function () {\n\t\t\t\tconst element = $(this);\n\t\t\t\tconst labelElement = element.find('label.' + column);\n\t\t\t\tconst label = labelElement.text();\n\t\t\t\tif (!filter || label.toLowerCase().indexOf(filter) !== -1) {\n\t\t\t\t\telement.removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\telement.addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tconst container = (this.container = $('#dotPdfExportModal').closest('.js-modal-container'));\n\t\tthis.dynamicTemplatesCount = 0;\n\t\tthis.recordId = parseInt(container.find('[name=\"record\"]').val());\n\t\tthis.registerPreSubmitEvent(container);\n\t\tthis.registerSaveInventoryColumnSchemeClick();\n\t\tthis.registerSelectCustomColumnsChange();\n\t\tthis.registerListViewCheckRecords(container);\n\t\tthis.registerListViewFilter(container);\n\t}\n});\n$(function () {\n\tnew Vtiger_DotPDF_Js().registerEvents();\n});\n"],"names":["$","Class","registerPreSubmitEvent","container","find","on","e","preventDefault","progressIndicator","message","app","vtranslate","position","blockInfo","enabled","templateElements","templateContainer","closest","toggleClass","filter","each","templates","push","val","serializeFormData","params","mode","AppConnector","request","done","data","result","response","showNotify","text","type","Vtiger_Detail_Js","getInstance","detailInstance","reloadTabContent","fail","err","errorLog","loader","hideModalWindow","registerListViewCheckRecords","document","progressLoader","success","valid","info","removeClass","addClass","setTimeout","attr","registerSelectCustomColumnsChange","ev","target","is","prop","registerSaveInventoryColumnSchemeClick","stopPropagation","isCustomMode","registerListViewFilter","currentTarget","element","toLowerCase","classes","split","column","className","startsWith","labelElement","label","indexOf","registerEvents","dynamicTemplatesCount","recordId","parseInt"],"mappings":"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"}