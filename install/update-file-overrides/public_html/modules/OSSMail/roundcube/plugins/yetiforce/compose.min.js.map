{"version":3,"file":"compose.min.js","sources":["compose.js"],"sourcesContent":["'use strict';\n/* {[The file is published on the basis of MIT License]} */\nif (window.rcmail) {\n\trcmail.addEventListener('init', function () {\n\t\trcmail.crm = rcmail.getCrmWindow();\n\t\tif (rcmail.crm != false) {\n\t\t\trcmail.env.compose_commands.push('yetiforce.addFilesFromCRM');\n\t\t\trcmail.env.compose_commands.push('yetiforce.selectTemplate');\n\t\t\trcmail.env.compose_commands.push('yetiforce.selectAdress');\n\t\t\trcmail.env.compose_commands.push('yetiforce.selectLabel');\n\t\t\trcmail.env.compose_commands.push('yetiforce.chooseRecord');\n\t\t\trcmail.env.compose_commands.push('yetiforce.refreshTemplate');\n\t\t\trcmail.register_command(\n\t\t\t\t'yetiforce.addFilesFromCRM',\n\t\t\t\tfunction () {\n\t\t\t\t\trcmail.addFilesFromCRM();\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t\trcmail.register_command(\n\t\t\t\t'yetiforce.selectTemplate',\n\t\t\t\tfunction () {\n\t\t\t\t\trcmail.selectTemplate();\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t\trcmail.register_command(\n\t\t\t\t'yetiforce.selectAdress',\n\t\t\t\tfunction (module, part) {\n\t\t\t\t\trcmail.selectAdress(module, part);\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t\trcmail.register_command(\n\t\t\t\t'yetiforce.selectLabel',\n\t\t\t\tfunction (module, part) {\n\t\t\t\t\trcmail.selectLabel(module, part);\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t\trcmail.register_command(\n\t\t\t\t'yetiforce.chooseRecord',\n\t\t\t\tfunction (module, part) {\n\t\t\t\t\trcmail.chooseRecord(module, part);\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t\trcmail.register_command(\n\t\t\t\t'yetiforce.refreshTemplate',\n\t\t\t\tfunction (module, part) {\n\t\t\t\t\trcmail.refreshTemplate();\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\tif (rcmail.env.yf_crmRecordLabel) {\n\t\t\t\t$('#baseRecordId').val(rcmail.env.yf_crmRecord);\n\t\t\t\t$('#baseRecordModule').val(rcmail.env.yf_crmModule);\n\t\t\t\t$('#baseRecordLink').text(rcmail.env.yf_crmRecordLabel);\n\t\t\t\t$('#baseRecordLink').attr('title', rcmail.env.yf_crmRecordLabel);\n\t\t\t\t$('#baseRecordLink').attr('href', rcmail.crm.CONFIG.siteUrl + 'index.php?module=' + rcmail.env.yf_crmModule + '&view=Detail&record=' + rcmail.env.yf_crmRecord);\n\t\t\t\tif (!$('#baseRecordEmpty').hasClass('d-none')) {\n\t\t\t\t\t$('#baseRecordEmpty').addClass('d-none');\n\t\t\t\t}\n\t\t\t\t$('#baseRecordLink').removeClass('d-none');\n\t\t\t}\n\t\t} else {\n\t\t\tjQuery('.yetiforce').hide();\n\t\t}\n\t});\n}\n//Document selection\nrcube_webmail.prototype.addFilesFromCRM = function () {\n\trcmail.crm.app.showRecordsList(\n\t\t{\n\t\t\tmodule: 'Documents',\n\t\t\tsrc_module: 'Documents',\n\t\t\tmulti_select: true,\n\t\t\tadditionalInformations: true,\n\t\t\tsearch_params: [[['filelocationtype', 'e', 'I']]]\n\t\t},\n\t\t(modal, instance) => {\n\t\t\tinstance.setSelectEvent((responseData) => {\n\t\t\t\trcmail.addFilesToMail({\n\t\t\t\t\tids: Object.keys(responseData)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t);\n};\n//Add files to mail\nrcube_webmail.prototype.addFilesToMail = function (data) {\n\tdata._id = rcmail.env.compose_id;\n\tdata._uploadid = new Date().getTime();\n\tthis.http_post('plugin.yetiforce-addFilesToMail', data, this.set_busy(true, 'loading'));\n};\n// Select template\nrcube_webmail.prototype.selectTemplate = function () {\n\trcmail.crm.app.showRecordsList(\n\t\t{\n\t\t\tmodule: 'EmailTemplates',\n\t\t\tsrc_module: 'EmailTemplates',\n\t\t},\n\t\t(modal, instance) => {\n\t\t\tinstance.setSelectEvent((responseData) => {\n\t\t\t\tvar recordId = $('#baseRecordId').val() || rcmail.env.yf_crmRecord,\n\t\t\t\t\tmodule = $('#baseRecordModule').val() || rcmail.env.yf_crmModule,\n\t\t\t\t\tview = rcmail.env.yf_crmView;\n\t\t\t\tif (view == 'List') {\n\t\t\t\t\tvar chElement = jQuery(crm.document).find('.listViewEntriesCheckBox')[0];\n\t\t\t\t\trecordId = jQuery(chElement).val();\n\t\t\t\t}\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'Get',\n\t\t\t\t\turl: '?_task=mail&_action=plugin.yetiforce-getContentEmailTemplate&_id=' + rcmail.env.compose_id,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: responseData.id,\n\t\t\t\t\t\trecord_id: recordId,\n\t\t\t\t\t\tselect_module: module\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function (data) {\n\t\t\t\t\t\t$('#currentTemplate').val(responseData.id);\n\t\t\t\t\t\tlet html = jQuery('<div/>').html(data.content).html(),\n\t\t\t\t\t\t\ted = '';\n\t\t\t\t\t\tjQuery('[name=\"_subject\"]').val(data.subject);\n\t\t\t\t\t\tif (window.tinyMCE && (ed = tinyMCE.get(rcmail.env.composebody))) {\n\t\t\t\t\t\t\ttinymce.activeEditor.setContent(html);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tjQuery('#composebody').val(html);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tjQuery('[name=\"_to\"]').val(data.to);\n\t\t\t\t\t\tjQuery('[name=\"_to\"]').change();\n\t\t\t\t\t\tjQuery('[name=\"_cc\"]').val(data.cc);\n\t\t\t\t\t\tjQuery('[name=\"_cc\"]').change();\n\t\t\t\t\t\t$('[href=\"#delete\"]').each(function () {\n\t\t\t\t\t\t\t$(this).trigger('click');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (typeof data.attachments !== 'undefined' && data.attachments !== null) {\n\t\t\t\t\t\t\trcmail.addFilesToMail(data.attachments);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t);\n};\nrcube_webmail.prototype.selectAdress = function (module, part) {\n\trcmail.crm.app.showRecordsList(\n\t\t{\n\t\t\tmodule: module,\n\t\t\tsrc_module: 'OSSMail',\n\t\t\tmulti_select: true,\n\t\t\tadditionalInformations: false\n\t\t},\n\t\t(modal, instance) => {\n\t\t\tinstance.setSelectEvent((responseData, e) => {\n\t\t\t\trcmail.getEmailAddresses(responseData, e, module).done((emails) => {\n\t\t\t\t\tif (emails.length) {\n\t\t\t\t\t\tlet paetElement = $('#' + part);\n\t\t\t\t\t\tlet value = paetElement.val();\n\t\t\t\t\t\tif (value != '' && value.charAt(value.length - 1) != ',') {\n\t\t\t\t\t\t\tvalue = value + ',';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpaetElement.val(value + emails.join(','));\n\t\t\t\t\t\tpaetElement.change();\n\t\t\t\t\t} else {\n\t\t\t\t\t\trcmail.crm.app.showNotify({\n\t\t\t\t\t\t\ttext: rcmail.crm.app.vtranslate('NoFindEmailInRecord'),\n\t\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t);\n};\nrcube_webmail.prototype.getEmailAddresses = function (responseData, e, module) {\n\tlet aDeferred = $.Deferred(),\n\t\temails = [],\n\t\tlabel = '',\n\t\temail = '';\n\tif (\n\t\ttypeof e.target !== 'undefined' &&\n\t\t($(e.target).data('type') === 'email' || $(e.target).data('type') === 'multiEmail')\n\t) {\n\t\temails.push($(e.target).text());\n\t\taDeferred.resolve(emails);\n\t} else {\n\t\tlet i = 0;\n\t\tfor (let id in responseData) {\n\t\t\trcmail.crm.app\n\t\t\t\t.getRecordDetails({\n\t\t\t\t\trecord: id,\n\t\t\t\t\tmodule: module,\n\t\t\t\t\tfieldType: ['email', 'multiEmail']\n\t\t\t\t})\n\t\t\t\t.done((data) => {\n\t\t\t\t\ti++;\n\t\t\t\t\tlabel = email = rcmail.getFirstEmailAddress(data.result.data);\n\t\t\t\t\tif (responseData[id]) {\n\t\t\t\t\t\tlabel = responseData[id];\n\t\t\t\t\t}\n\t\t\t\t\temails.push(label + '<' + email + '>');\n\t\t\t\t\tif (i === Object.keys(responseData).length) {\n\t\t\t\t\t\t//last iteration\n\t\t\t\t\t\taDeferred.resolve(emails);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t}\n\treturn aDeferred.promise();\n};\nrcube_webmail.prototype.getFirstEmailAddress = function (data) {\n\tlet emails = [];\n\tfor (let key in data) {\n\t\tif (data[key]) {\n\t\t\tif (rcmail.crm.app.isJsonString(data[key])) {\n\t\t\t\tlet multiEmail = JSON.parse(data[key]);\n\t\t\t\tfor (let i in multiEmail) {\n\t\t\t\t\temails.push(multiEmail[i].e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\temails.push(data[key]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn emails;\n};\nrcube_webmail.prototype.selectLabel = function (module, part) {\n\trcmail.crm.app.showRecordsList(\n\t\t{\n\t\t\tmodule: module,\n\t\t\tsrc_module: 'OSSMail',\n\t\t\tmulti_select: true,\n\t\t\tadditionalInformations: false\n\t\t},\n\t\t(modal, instance) => {\n\t\t\tinstance.setSelectEvent((responseData, e) => {\n\t\t\t\tconst labels = []\n\t\t\t\tfor (let id in responseData) {\n\t\t\t\t\tlabels.push('[' + responseData[id] + ']');\n\t\t\t\t}\n\t\t\t\tlet ed = undefined;\n\t\t\t\tif (part === 'composebody' && window.tinyMCE && (ed = tinyMCE.get(rcmail.env.composebody))) {\n\t\t\t\t\ted.execCommand('mceInsertContent', false, labels.join(', '));\n\t\t\t\t} else {\n\t\t\t\t\tlet partElement = $('#' + part);\n\t\t\t\t\tconst caretPos = partElement.get(0).selectionStart;\n\t\t\t\t\tconst caretEnd = partElement.get(0).selectionEnd;\n\t\t\t\t\tconst oldText = partElement.val();\n\t\t\t\t\tconst txtToAdd = labels.join(', ');\n\t\t\t\t\tpartElement.val(oldText.substring(0, caretPos) + txtToAdd + oldText.substring(caretEnd));\n\n\t\t\t\t\tpartElement.get(0).selectionStart = caretPos + txtToAdd.length;\n\t\t\t\t\tpartElement.get(0).selectionEnd = caretPos + txtToAdd.length;\n\t\t\t\t\tpartElement.focus();\n\t\t\t\t\tpartElement.change();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t);\n};\nrcube_webmail.prototype.chooseRecord = function (module, part) {\n\trcmail.crm.app.showRecordsList(\n\t\t{\n\t\t\tmodule: module,\n\t\t\tsrc_module: 'OSSMail',\n\t\t\tmulti_select: false,\n\t\t\tadditionalInformations: true\n\t\t},\n\t\t(modal, instance) => {\n\t\t\tinstance.setSelectEvent((responseData, e) => {\n\t\t\t\t$('#baseRecordId').val(responseData.id);\n\t\t\t\t$('#baseRecordModule').val(module);\n\t\t\t\t$('#baseRecordLink').text(responseData.name);\n\t\t\t\t$('#baseRecordLink').attr('title', responseData.name);\n\t\t\t\t$('#baseRecordLink').attr('href', rcmail.crm.CONFIG.siteUrl + 'index.php?module=' + module + '&view=Detail&record=' + responseData.id);\n\t\t\t\tif (!$('#baseRecordEmpty').hasClass('d-none')) {\n\t\t\t\t\t$('#baseRecordEmpty').addClass('d-none');\n\t\t\t\t}\n\t\t\t\t$('#baseRecordLink').removeClass('d-none');\n\n\t\t\t\tlet templateId = $('#currentTemplate').val();\n\t\t\t\tif (templateId > 0) {\n\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\ttype: 'Get',\n\t\t\t\t\t\turl: '?_task=mail&_action=plugin.yetiforce-getContentEmailTemplate&_id=' + rcmail.env.compose_id,\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: templateId,\n\t\t\t\t\t\t\trecord_id: responseData.id,\n\t\t\t\t\t\t\tselect_module: module\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\tsuccess: function (data) {\n\t\t\t\t\t\t\tlet html = jQuery('<div/>').html(data.content).html(),\n\t\t\t\t\t\t\t\ted = '';\n\t\t\t\t\t\t\tjQuery('[name=\"_subject\"]').val(data.subject);\n\t\t\t\t\t\t\tif (window.tinyMCE && (ed = tinyMCE.get(rcmail.env.composebody))) {\n\t\t\t\t\t\t\t\ttinymce.activeEditor.setContent(html);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tjQuery('#composebody').val(html);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tjQuery('[name=\"_to\"]').val(data.to);\n\t\t\t\t\t\t\tjQuery('[name=\"_to\"]').change();\n\t\t\t\t\t\t\tjQuery('[name=\"_cc\"]').val(data.cc);\n\t\t\t\t\t\t\tjQuery('[name=\"_cc\"]').change();\n\t\t\t\t\t\t\t$('[href=\"#delete\"]').each(function () {\n\t\t\t\t\t\t\t\t$(this).trigger('click');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (typeof data.attachments !== 'undefined' && data.attachments !== null) {\n\t\t\t\t\t\t\t\trcmail.addFilesToMail(data.attachments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t);\n};\nrcube_webmail.prototype.refreshTemplate = function () {\n\tlet templateId = $('#currentTemplate').val();\n\tlet recordId = $('#baseRecordId').val();\n\tlet module = $('#baseRecordModule').val();\n\n\tif (templateId > 0 && recordId > 0 && !!module) {\n\t\tjQuery.ajax({\n\t\t\ttype: 'Get',\n\t\t\turl: '?_task=mail&_action=plugin.yetiforce-getContentEmailTemplate&_id=' + rcmail.env.compose_id,\n\t\t\tdata: {\n\t\t\t\tid: templateId,\n\t\t\t\trecord_id: recordId,\n\t\t\t\tselect_module: module\n\t\t\t},\n\t\t\tdataType: 'json',\n\t\t\tsuccess: function (data) {\n\t\t\t\tlet html = jQuery('<div/>').html(data.content).html(),\n\t\t\t\t\ted = '';\n\t\t\t\tjQuery('[name=\"_subject\"]').val(data.subject);\n\t\t\t\tif (window.tinyMCE && (ed = tinyMCE.get(rcmail.env.composebody))) {\n\t\t\t\t\ttinymce.activeEditor.setContent(html);\n\t\t\t\t} else {\n\t\t\t\t\tjQuery('#composebody').val(html);\n\t\t\t\t}\n\t\t\t\tjQuery('[name=\"_to\"]').val(data.to);\n\t\t\t\tjQuery('[name=\"_to\"]').change();\n\t\t\t\tjQuery('[name=\"_cc\"]').val(data.cc);\n\t\t\t\tjQuery('[name=\"_cc\"]').change();\n\t\t\t\t$('[href=\"#delete\"]').each(function () {\n\t\t\t\t\t$(this).trigger('click');\n\t\t\t\t});\n\t\t\t\tif (typeof data.attachments !== 'undefined' && data.attachments !== null) {\n\t\t\t\t\trcmail.addFilesToMail(data.attachments);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\nrcube_webmail.prototype.getCrmWindow = function () {\n\tif (opener !== null && typeof opener.parent.CONFIG == 'object') {\n\t\treturn opener.parent;\n\t} else if (parent !== null && typeof parent.CONFIG == 'object') {\n\t\treturn parent;\n\t} else if (parent !== null && parent.opener !== null && typeof parent.opener.CONFIG == 'object') {\n\t\treturn parent.opener;\n\t} else if (parent !== null && parent.parent !== null && typeof parent.parent.CONFIG == 'object') {\n\t\treturn parent.parent;\n\t} else if (opener !== null && opener.crm !== null && typeof opener.crm == 'object' && typeof opener.crm.CONFIG == 'object') {\n\t\treturn opener.crm;\n\t}\n\treturn false;\n};\n"],"names":["window","rcmail","addEventListener","crm","getCrmWindow","jQuery","hide","env","compose_commands","push","register_command","addFilesFromCRM","selectTemplate","module","part","selectAdress","selectLabel","chooseRecord","refreshTemplate","yf_crmRecordLabel","$","val","yf_crmRecord","yf_crmModule","text","attr","CONFIG","siteUrl","hasClass","addClass","removeClass","rcube_webmail","prototype","app","showRecordsList","src_module","multi_select","additionalInformations","search_params","modal","instance","setSelectEvent","responseData","addFilesToMail","ids","Object","keys","data","_id","compose_id","_uploadid","getTime","http_post","set_busy","view","yf_crmView","document","find","recordId","chElement","ajax","type","url","id","record_id","select_module","dataType","success","html","content","ed","subject","tinyMCE","get","composebody","tinymce","activeEditor","setContent","to","change","cc","each","trigger","attachments","e","getEmailAddresses","done","emails","length","value","paetElement","charAt","join","showNotify","vtranslate","animation","Deferred","label","email","target","aDeferred","resolve","getRecordDetails","record","fieldType","i","getFirstEmailAddress","result","promise","key","isJsonString","JSON","parse","multiEmail","labels","execCommand","caretPos","partElement","selectionStart","caretEnd","selectionEnd","oldText","txtToAdd","substring","focus","name","templateId","opener","parent"],"mappings":"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"}